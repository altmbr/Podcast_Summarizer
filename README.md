# Teahose - Tech Podcast Summaries

A high-performance Next.js website for browsing and viewing AI-generated podcast summaries and transcripts. Fully optimized for SEO with static site generation, structured data, and comprehensive metadata.

## Features

### Content
- **Homepage**: Grid view of all podcasts with episode counts
- **Podcast Pages**: List of all episodes per podcast, sorted by date
- **Episode Pages**: Full AI-generated summaries with clickable YouTube timestamps
- **Transcript Viewing**: Full transcripts with speaker identification and timestamps
- **Newsletter Subscription**: Email capture for daily digest (stored in Vercel KV)
- **Daily Email Digest**: Automatic daily emails with new episode summaries (via Vercel Cron)

### Performance & SEO
- **Static Site Generation (SSG)**: 100+ pages pre-rendered at build time
- **Edge Caching**: Instant page loads via Vercel CDN worldwide
- **Dynamic Sitemap**: Auto-generated `/sitemap.xml` with 200+ URLs
- **Structured Data**: JSON-LD schema for PodcastEpisode, PodcastSeries, Organization
- **Unique Metadata**: SEO-optimized titles and descriptions per page
- **Canonical URLs**: Prevents duplicate content issues
- **Image Optimization**: Next.js automatic optimization enabled
- **Open Graph & Twitter Cards**: Rich social media previews

### Design
- **Responsive Design**: Mobile-first, works on all devices
- **Elegant Branding**: Cream/charcoal color scheme with muted blue accents
- **Clean Typography**: Geist font family, light weight
- **Minimal UI**: Content-focused, sophisticated aesthetic

## Tech Stack

- **Next.js 16**: React framework with App Router & Server Components
- **TypeScript**: Type-safe code
- **Tailwind CSS 4**: Utility-first styling with custom theme
- **React Markdown**: Render markdown summaries and transcripts
- **Vercel**: Deployment platform with edge caching
- **PostHog**: Analytics and newsletter subscription tracking
- **Vercel KV**: Redis-compatible storage for email addresses

## Project Structure

```
teahose/
â”œâ”€â”€ app/                                    # Next.js App Router
â”‚   â”œâ”€â”€ page.tsx                           # Homepage (client component)
â”‚   â”œâ”€â”€ layout.tsx                         # Root layout with schemas
â”‚   â”œâ”€â”€ globals.css                        # Global styles & theme
â”‚   â”œâ”€â”€ sitemap.ts                         # Dynamic sitemap generation
â”‚   â”œâ”€â”€ robots.ts                          # Robots.txt
â”‚   â”œâ”€â”€ podcast/[name]/
â”‚   â”‚   â”œâ”€â”€ page.tsx                       # Podcast page (SSG + metadata)
â”‚   â”‚   â””â”€â”€ [episode]/
â”‚   â”‚       â”œâ”€â”€ page.tsx                   # Episode page (SSG + metadata)
â”‚   â”‚       â””â”€â”€ EpisodeClient.tsx          # Tab switching (client)
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ newsletter/route.ts            # Newsletter subscription
â”‚   â”‚   â”œâ”€â”€ cron/daily-email/route.ts      # Daily email cron job
â”‚   â”‚   â””â”€â”€ podcasts/                      # Podcast data APIs
â”‚   â””â”€â”€ providers.tsx                      # PostHog provider
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ MarkdownRenderer.tsx               # Markdown rendering
â”‚   â”œâ”€â”€ NewsletterSubscribe.tsx            # Newsletter banner
â”‚   â””â”€â”€ StructuredData.tsx                 # JSON-LD schema wrapper
â”œâ”€â”€ lib/
â”‚   â”œâ”€â”€ episodes.ts                        # Server-side data loading (SSG)
â”‚   â””â”€â”€ schema.ts                          # Schema.org generation utilities
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ og-image.png                       # Social media preview image
â”‚   â””â”€â”€ favicon.ico                        # Teacup favicon
â”œâ”€â”€ podcast_work/                          # Episode content (read by SSG)
â”‚   â””â”€â”€ [podcast]/[episode]/
â”‚       â”œâ”€â”€ summary.md                     # AI-generated summary
â”‚       â””â”€â”€ transcript.md                  # Transcript with timestamps
â”œâ”€â”€ next.config.js                         # Next.js configuration
â””â”€â”€ tailwind.config.ts                     # Tailwind theme customization
```

## Data Source

The website reads data from the local filesystem at **build time** (SSG):
- `podcast_work/` - Episode folders with summary.md and transcript.md files
- Episode metadata parsed from summary.md frontmatter
- No runtime database or API calls needed

### Content Generation

Episodes are processed by the **Podcast Summarizer** Python backend:
- **MLX-Whisper** - Local GPU-accelerated transcription (M1/M2 Macs, FREE)
- **pyannote.audio** - Voice-based speaker diarization
- **Claude Sonnet 4.5** - AI-powered summaries (16K tokens)
- Supports YouTube playlists and Xiaoyuzhou (Chinese) podcasts
- One-off episode processing with automatic cleanup

For full details on the processing pipeline, see `.claude/CLAUDE.md`

## Local Development

### Prerequisites

- Node.js 18+
- npm or yarn
- `podcast_work/` folder with episode content (generated by `podcast_summarizer.py`)

### Installation

```bash
# Install dependencies
npm install

# Run development server
npm run dev
```

Visit http://localhost:3000 to view the website.

### Build for Production

```bash
# Generate static site (SSG)
npm run build
# Build time: ~23 minutes for 100+ pages

# Preview production build
npm run start
```

The build process:
1. Scans `podcast_work/` directory for all podcasts and episodes
2. Pre-renders 100+ static HTML pages using `generateStaticParams()`
3. Generates sitemap.xml with all URLs
4. Optimizes images and assets
5. Outputs static files ready for CDN deployment

## Configuration

### Environment Variables

**Required for Newsletter (optional):**
- `KV_REST_API_URL` - Vercel KV endpoint
- `KV_REST_API_TOKEN` - Vercel KV auth token

**Required for Daily Email Digest:**
- `SENDGRID_API_KEY` - SendGrid API key for sending emails
- `ANTHROPIC_API_KEY` - For generating episode descriptions
- `GOOGLE_API_KEY` - For generating header images (Gemini)
- `CRON_SECRET` - Optional: secure the cron endpoint

**Required for Analytics (optional):**
- `NEXT_PUBLIC_POSTHOG_KEY` - PostHog project key
- `NEXT_PUBLIC_POSTHOG_HOST` - PostHog API host

The site works without these - they only enable newsletter subscriptions, daily emails, and analytics tracking.

## Deployment to Vercel

### GitHub Integration (Recommended)

**Initial Setup:**
1. Push code to GitHub repository
2. Visit [vercel.com](https://vercel.com) and connect GitHub
3. Import your repository
4. Vercel auto-detects Next.js and configures build settings
5. Add environment variables (if using newsletter/analytics)
6. Deploy!

**Automatic Deployments:**
- Every push to `main` branch triggers automatic rebuild and deployment
- Build time: ~23 minutes for full SSG (100+ pages)
- Vercel caches unchanged pages for faster subsequent builds
- Site deploys to global edge CDN automatically

**Custom Domain:**
- Add `teahose.com` in Vercel dashboard â†’ Domains
- Configure DNS: Add CNAME record pointing to Vercel
- SSL certificate auto-provisioned

### Deployment Configuration

**next.config.js:**
```javascript
const nextConfig = {
  images: {
    // Next.js automatic image optimization enabled
    remotePatterns: [
      {
        protocol: 'https',
        hostname: '**',
      },
    ],
  },
}
```

**Build Settings (Vercel Dashboard):**
- Framework: Next.js (auto-detected)
- Build Command: `npm run build`
- Output Directory: `.next` (auto)
- Install Command: `npm install`
- Node Version: 18.x

### Redeployment Workflow

**To add new episodes:**

1. **Process episodes locally:**
   ```bash
   python podcast_summarizer.py
   # Select and process new episodes
   ```

2. **Commit and push:**
   ```bash
   git add podcast_work/
   git commit -m "Add new podcast episodes"
   git push
   ```

3. **Vercel auto-rebuilds:**
   - Detects new episodes in `podcast_work/`
   - Regenerates sitemap with new URLs
   - Pre-renders new episode pages
   - Updates structured data
   - Deploys to production (~23 min build)

**The site automatically:**
- âœ… Adds new episodes to sitemap.xml
- âœ… Generates static HTML for new pages
- âœ… Creates unique metadata per episode
- âœ… Updates podcast page episode counts
- âœ… Notifies Google via sitemap

## SEO Features

### Technical SEO
- âœ… **Dynamic Sitemap**: `/sitemap.xml` with 200+ URLs
- âœ… **Robots.txt**: `/robots.txt` for crawl guidance
- âœ… **Structured Data**: JSON-LD schemas (PodcastEpisode, PodcastSeries, Organization)
- âœ… **Rich Snippets**: Eligible for enhanced search results
- âœ… **Static Generation**: Pre-rendered HTML for instant indexing
- âœ… **Canonical URLs**: Prevents duplicate content

### On-Page SEO
- âœ… **Unique Titles**: Per-page SEO-optimized titles
- âœ… **Meta Descriptions**: Auto-generated from summaries (160 char)
- âœ… **Open Graph Tags**: Rich social media previews
- âœ… **Twitter Cards**: `summary_large_image` format
- âœ… **Semantic HTML**: Proper H1-H6 hierarchy
- âœ… **Clean URLs**: Human-readable slugs

### Performance
- âœ… **Core Web Vitals**: Optimized LCP, FID, CLS
- âœ… **Image Optimization**: Next.js automatic optimization
- âœ… **Edge Caching**: Global CDN distribution
- âœ… **Lazy Loading**: Progressive content loading

### Google Search Console
1. Verify ownership at https://search.google.com/search-console
2. Submit sitemap: `sitemap.xml` or `https://www.teahose.com/sitemap.xml`
3. Monitor indexing progress (target: 200+ pages)
4. Track CTR, impressions, and rankings

## URL Structure

Clean, SEO-friendly URLs:
- Homepage: `/`
- Podcast: `/podcast/20VC`
- Episode: `/podcast/20VC/Deel%20CEO%2C%20Alex%20Bouaziz...`
- Sitemap: `/sitemap.xml`
- Robots: `/robots.txt`

All URLs are human-readable and encode special characters properly.

## Features

### âœ… Implemented
- Homepage with podcast grid
- Podcast detail pages with episode lists
- Episode pages with summaries and transcripts
- Tab switching (Summary/Transcript)
- Newsletter subscription banner
- Daily email digest (Vercel Cron + SendGrid)
- Responsive design
- Static site generation (SSG)
- SEO optimization (sitemap, metadata, structured data)
- Social media preview images
- Teacup favicon
- Analytics (PostHog)

### ðŸ”® Future Enhancements
- [ ] Internal linking (related episodes)
- [ ] Breadcrumb navigation
- [ ] Search functionality
- [ ] Topic/tag taxonomy
- [ ] Weekly summary pages
- [ ] Dark mode
- [ ] RSS feed
- [ ] Article schema for summaries
- [ ] Video schema for YouTube links

## Troubleshooting

### "No podcasts found" or empty homepage
**Cause**: Missing or empty `podcast_work/` directory

**Solution**:
1. Run `podcast_summarizer.py` to generate episodes
2. Ensure episodes have `summary.md` files
3. Rebuild: `npm run build`

### Build fails with "ENOENT: no such file"
**Cause**: Episode folder missing `summary.md` file

**Solution**:
1. Check error message for specific episode path
2. Either complete the episode processing or delete the incomplete folder
3. Rebuild: `npm run build`

### Long build times (>30 minutes)
**Normal**: SSG builds 100+ pages, taking ~23 minutes

**To speed up**:
- Vercel caches unchanged pages automatically
- First build is slowest, subsequent builds are faster
- Consider reducing episodes during development

### Sitemap not updating with new episodes
**Cause**: Build cache or old deployment

**Solution**:
1. Push new episodes to GitHub
2. Vercel auto-rebuilds and regenerates sitemap
3. Check `/sitemap.xml` after deployment completes
4. May take 5-10 minutes to propagate to CDN

### Google Search Console: "Couldn't fetch sitemap"
**Cause**: URL redirect or DNS propagation

**Solution**:
1. Test sitemap directly: https://www.teahose.com/sitemap.xml
2. Use full URL in GSC: `https://www.teahose.com/sitemap.xml`
3. Verify correct property (www vs non-www)
4. Wait 5-10 minutes after deployment

### Images not optimizing
**Check**: `next.config.js` should NOT have `unoptimized: true`

**Correct config**:
```javascript
images: {
  remotePatterns: [{ protocol: 'https', hostname: '**' }]
}
```

### TypeScript errors during build
**Solution**:
1. Run `npm run build` locally to see errors
2. Fix type issues in component files
3. Ensure all imports are correct
4. Delete `.next` folder and rebuild

## Performance Tips

### Optimize Local Development
```bash
# Skip building all pages during development
# Edit specific page files, hot reload works instantly
npm run dev
```

### Monitor Build Performance
- Check Vercel dashboard for build times
- First build: ~25 minutes (cold cache)
- Subsequent builds: ~15-20 minutes (warm cache)
- Unchanged pages reuse cached builds

### Reduce Build Time (if needed)
- Limit episodes in `podcast_work/` during dev
- Use `/api/podcasts` routes for dynamic data in dev
- Full SSG build only needed for production deployment

## License

Same as main podcast summarizer project.

---

**Live Site**: https://teahose.com
**GitHub**: https://github.com/altmbr/Podcast_Summarizer
